<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>04 Big Data Analysis • mapme.forest</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="04 Big Data Analysis">
<meta property="og:description" content="mapme.forest">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mapme.forest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GFW.html">01 Download &amp; Preprocessing</a>
    </li>
    <li>
      <a href="../articles/area_stats.html">02 Area Statistics</a>
    </li>
    <li>
      <a href="../articles/big_data.html">04 Big Data Analysis</a>
    </li>
    <li>
      <a href="../articles/frag_stats.html">03 Fragmentation Statistics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="big_data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="big_data_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="big_data_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>04 Big Data Analysis</h1>
                        <h4 class="author">Darius Görgen</h4>
            
            <h4 class="date">2020-12-14</h4>
      
      
      <div class="hidden name"><code>big_data.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mapme.forest</span><span class="op">)</span></code></pre></div>
<p>The previously demonstrated R routines base on the <code>raster</code> package which uses quite a lot of RAM and this can be inefficient when it comes to the analysis of very large rasters. In order to make the analysis of extensive regions feasible we developed a routine using <a href="https://grass.osgeo.org/">GRASS GIS</a> for the complete processing chain from pre-processing GFW data to the extraction of zonal statistics. This routine is very RAM efficient rendering the analysis of large areas possible even when only restricted hardware is available (8GB of RAM should be enough for most use cases).</p>
<p>Equally to most of the other functions, it is expected that the path to the GDAL binaries is exposed in your environment variable (refer to the README of this package for more information). Additionally, the path to a working installation of GRASS GIS version &gt;=7.0.0 is required for the function to work properly. Internally, the function uses the <a href="https://grass.osgeo.org/grass78/manuals/addons/r.area.html"><code>r.area</code></a> addon, which will be installed automatically if it is not present in the specified addon path option.</p>
<p>As inputs to the function it is required to specify the path to the tree cover, loss year and CO2 emission files which cover the area of the polygons you are interested in. We advise you to use the files you obtained by calling <code>downloadGFW()</code> with your area of interest, however, also raster files obtained in another way are suitable for the routine.</p>
<p>The function call with the sample data from this package then looks like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get the file paths to the raster files</span>
<span class="va">treeCover</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pkgTest_treecover2000.tif"</span>, package <span class="op">=</span> <span class="st">"mapme.forest"</span><span class="op">)</span>
<span class="va">lossYear</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pkgTest_lossyear.tif"</span>, package <span class="op">=</span> <span class="st">"mapme.forest"</span><span class="op">)</span>
<span class="va">co2Layer</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pkgTest_co2_emission.tif"</span>, package <span class="op">=</span> <span class="st">"mapme.forest"</span><span class="op">)</span>
<span class="co"># read the area of interest</span>
<span class="va">roi</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"aoi_polys.gpkg"</span>, package <span class="op">=</span> <span class="st">"mapme.forest"</span><span class="op">)</span><span class="op">)</span>

<span class="va">grass</span> <span class="op">=</span> <span class="st">"/usr/lib/grass78"</span>

<span class="va">roi_stats</span> <span class="op">=</span> <span class="fu"><a href="../reference/statsGRASS.html">statsGRASS</a></span><span class="op">(</span>grass <span class="op">=</span> <span class="va">grass</span>, 
                       addon_base <span class="op">=</span> <span class="st">"./data-raw/addons"</span>, 
                       areas <span class="op">=</span> <span class="va">roi</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, 
                       tree_cover <span class="op">=</span> <span class="va">treeCover</span>, 
                       tree_loss <span class="op">=</span> <span class="va">lossYear</span>, 
                       tree_co2 <span class="op">=</span> <span class="va">co2Layer</span>, 
                       idcol <span class="op">=</span>  <span class="st">"id"</span>, 
                       thresholdClump <span class="op">=</span> <span class="fl">10</span>, 
                       thresholdCover <span class="op">=</span> <span class="fl">50</span>, 
                       years <span class="op">=</span> <span class="fl">2001</span><span class="op">:</span><span class="fl">2018</span>, 
                       saveRaster <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<p>This will deliver us the sf-object which entered the function with its dataframe amended by the yearly forest cover area, tree cover loss area (both in ha) and CO2 emissions. Additionally, we can turn the <code>saveRaster</code> switch to TRUE and specify a <code>outdir</code> variable in cases we want the raster output be written to disk. The first layer then represents the raw GFW tree cover with values between 0 and 100, the second layer the loss year layer, in this case with values between 0 and 18, the third layer the values of the CO2 emission equivalent, and then as many layers as specified in the years options starting from the year 2000.</p>
<p>As mentioned above, this function runs very efficiently. You can hand it a very high number of polygons simultaneously, each uniquely identified by the value in the column you specify in <code>idcol</code>. Make sure the raster files you hand to the function do cover all polygons and the function will clip and process for each polygon after another. For the cases you selected to save the resulting raster files, inside the specified <code>outdir</code> you will find a <code>GTiff</code> for each polygon named according to the value in <code>idcol</code>.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by KfW Bankengruppe, Darius Görgen, Fabian Löw.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
